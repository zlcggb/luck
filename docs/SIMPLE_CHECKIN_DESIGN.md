# 简化版签到系统设计文档

> 版本: 1.0.0  
> 日期: 2026-01-24  
> 作者: AI Assistant

---

## 1. 系统概述

### 1.1 设计理念

本签到系统采用**极简设计**，无需任何第三方认证（微信、企业微信等），用户通过扫描二维码进入签到页面后，只需输入**工号 + 姓名**即可完成签到。

### 1.2 核心优势

| 特性          | 说明                                   |
| ------------- | -------------------------------------- |
| ✅ 零配置     | 无需微信开放平台、企业微信等第三方配置 |
| ✅ 开发简单   | 纯前端实现，无需后端 Edge Function     |
| ✅ 部署快速   | 直接部署静态页面即可使用               |
| ✅ 用户覆盖广 | 任何手机浏览器都可使用                 |

### 1.3 适用场景

- 企业年会签到
- 活动现场签到
- 会议签到
- 培训签到

---

## 2. 用户流程

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              签到流程图                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                               │
│   ┌─────────────────┐                                                        │
│   │  扫描二维码      │  大屏展示二维码或分享链接                                │
│   │  打开签到页面    │                                                        │
│   └────────┬────────┘                                                        │
│            │                                                                  │
│            ▼                                                                  │
│   ┌─────────────────────────────────────────────────────────────────────────┐│
│   │                        输入信息页面                                      ││
│   │  ┌─────────────────────────────────────────────────────────────────┐   ││
│   │  │  🎉 年度盛典                                                     │   ││
│   │  │  请输入您的信息进行签到                                           │   ││
│   │  │                                                                   │   ││
│   │  │  员工工号: [________________]                                     │   ││
│   │  │  姓    名: [________________]                                     │   ││
│   │  │                                                                   │   ││
│   │  │           [ 开始签到 → ]                                          │   ││
│   │  └─────────────────────────────────────────────────────────────────┘   ││
│   └─────────────────────────────────────────────────────────────────────────┘│
│            │                                                                  │
│            ▼                                                                  │
│   ┌─────────────────────────────────────────────────────────────────────────┐│
│   │  验证逻辑                                                                ││
│   │  1. 检查是否已签到 → 是 → 显示"您已签到"                                 ││
│   │  2. 查找参与者名单验证工号+姓名匹配                                       ││
│   │  3. 如无名单，直接使用输入信息（宽松模式）                                 ││
│   └─────────────────────────────────────────────────────────────────────────┘│
│            │                                                                  │
│            ▼                                                                  │
│   ┌──────────────────────────────────────────────┐                           │
│   │ 需要定位?                                     │                           │
│   └──────────────────────────────────────────────┘                           │
│            │                                                                  │
│     ┌──────┴──────┐                                                          │
│     │             │                                                          │
│     ▼ 是          ▼ 否                                                       │
│   ┌────────┐  ┌────────────────────────────────────────────────────────────┐│
│   │获取GPS │  │                      确认签到页面                           ││
│   │定位    │  │  ┌─────────────────────────────────────────────────────┐   ││
│   └────┬───┘  │  │      [头像]                                          │   ││
│        │      │  │      张三                                             │   ││
│        │      │  │      技术研发中心                                      │   ││
│        │      │  │      EMP001                                           │   ││
│        │      │  │                                                       │   ││
│        │      │  │      欢迎参加年度盛典！🎉                              │   ││
│        │      │  │                                                       │   ││
│        │      │  │      [ ✓ 确认签到 ]                                   │   ││
│        │      │  │                                                       │   ││
│        │      │  │      返回修改信息                                      │   ││
│        │      │  └─────────────────────────────────────────────────────┘   ││
│        └──────► └────────────────────────────────────────────────────────────┘│
│            │                                                                  │
│            ▼                                                                  │
│   ┌─────────────────────────────────────────────────────────────────────────┐│
│   │                        签到成功页面                                      ││
│   │                                                                          ││
│   │                          ✓                                               ││
│   │                    签到成功！                                            ││
│   │                      张三                                                ││
│   │                    技术研发中心                                           ││
│   │                                                                          ││
│   │                    签到时间                                               ││
│   │                    15:30:25                                              ││
│   │                                                                          ││
│   │              欢迎参加年度盛典！🎉                                         ││
│   │                                                                          ││
│   └─────────────────────────────────────────────────────────────────────────┘│
│                                                                               │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 3. 技术架构

### 3.1 系统架构

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              技术架构图                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                               │
│   ┌─────────────────┐      ┌─────────────────┐      ┌───────────────────┐   │
│   │  员工手机端      │      │  大屏展示端      │      │  管理端           │   │
│   │  (签到页面)      │      │  (实时动态)      │      │  (SettingsPanel) │   │
│   └────────┬────────┘      └────────┬────────┘      └─────────┬─────────┘   │
│            │                        │                         │              │
│            └────────────────────────┼─────────────────────────┘              │
│                                     │                                         │
│                                     ▼                                         │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                        React 前端应用                                │   │
│   │   ┌───────────────────┐  ┌──────────────────┐  ┌────────────────┐   │   │
│   │   │ CheckInPage.tsx   │  │ CheckInDisplay   │  │ SettingsPanel  │   │   │
│   │   │ (签到页面)        │  │ Page.tsx         │  │ (管理设置)      │   │   │
│   │   └───────────────────┘  └──────────────────┘  └────────────────┘   │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                     │                                         │
│                                     ▼                                         │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                        LocalStorage 数据存储                         │   │
│   │   ┌───────────────────┐  ┌──────────────────┐  ┌────────────────┐   │   │
│   │   │ checkin_settings  │  │ checkin_records  │  │ lottery_       │   │   │
│   │   │ (签到设置)        │  │ (签到记录)        │  │ participants   │   │   │
│   │   └───────────────────┘  └──────────────────┘  └────────────────┘   │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                               │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 技术栈

| 层级     | 技术               | 说明           |
| -------- | ------------------ | -------------- |
| 前端框架 | React + TypeScript | 现代化前端开发 |
| 构建工具 | Vite               | 快速开发与构建 |
| 样式     | Tailwind CSS       | 原子化 CSS     |
| 数据存储 | LocalStorage       | 浏览器本地存储 |
| 定位     | Geolocation API    | 浏览器原生定位 |

### 3.3 页面状态机

```
┌──────────────┐
│   loading    │
└──────┬───────┘
       │
       ▼
┌──────────────┐     验证失败
│  input_info  │◄────────────────────┐
└──────┬───────┘                     │
       │ 提交表单                     │
       ▼                             │
┌──────────────┐                     │
│  validating  │─────────────────────┤
└──────┬───────┘                     │
       │                             │
       ├──► 已签到 ──► already_checked
       │
       ├──► 需要定位
       │    │
       │    ▼
       │  ┌──────────────┐
       │  │ get_location │
       │  └──────┬───────┘
       │         │
       └────┬────┘
            │
            ▼
     ┌──────────────┐
     │   confirm    │
     └──────┬───────┘
            │ 点击签到
            ▼
     ┌──────────────┐
     │ checking_in  │
     └──────┬───────┘
            │
            ▼
     ┌──────────────┐
     │   success    │
     └──────────────┘
```

---

## 4. 数据结构

### 4.1 签到记录

```typescript
interface CheckInRecord {
  id: string; // 签到记录ID
  eventId: string; // 活动ID
  employeeId: string; // 工号
  name: string; // 姓名
  department?: string; // 部门
  avatar?: string; // 头像URL
  checkInTime: string; // 签到时间 (ISO)
  locationLat?: number; // 纬度
  locationLng?: number; // 经度
  locationAccuracy?: number; // 定位精度
  checkInMethod: "qrcode" | "manual";
  createdAt: string;
}
```

### 4.2 签到设置

```typescript
interface CheckInSettings {
  eventName: string; // 活动名称
  eventDate: string; // 活动日期
  requireLocation: boolean; // 是否需要定位
  locationName?: string; // 位置名称
  locationLat?: number; // 目标纬度
  locationLng?: number; // 目标经度
  locationRadius?: number; // 有效半径(米)
  showQRCode: boolean; // 大屏是否显示二维码
  // ... 其他配置
}
```

---

## 5. 功能特性

### 5.1 核心功能

| 功能          | 描述                         | 状态      |
| ------------- | ---------------------------- | --------- |
| 工号+姓名签到 | 输入工号和姓名进行签到       | ✅ 已实现 |
| 名单验证      | 可选验证工号姓名是否在名单中 | ✅ 已实现 |
| 定位签到      | 可选获取GPS定位              | ✅ 已实现 |
| 防重复签到    | 同一工号只能签到一次         | ✅ 已实现 |
| 大屏展示      | 实时显示签到动态             | ✅ 已实现 |
| 签到统计      | 显示签到人数和进度           | ✅ 已实现 |

### 5.2 验证模式

#### 严格模式（有名单时）

1. 验证工号是否存在于参与者名单
2. 验证姓名是否与工号匹配
3. 两者都匹配才允许签到

#### 宽松模式（无名单时）

1. 直接使用用户输入的工号和姓名
2. 只检查是否已签到

---

## 6. 使用指南

### 6.1 管理员操作

1. **配置活动信息**
   - 在 SettingsPanel 中设置活动名称、日期
   - 配置是否需要定位验证

2. **导入参与者名单**（可选）
   - 通过 Excel 导入参与者信息
   - 包含工号、姓名、部门等

3. **打开大屏展示**
   - 访问 `/checkin-display` 页面
   - 展示签到二维码和实时动态

### 6.2 用户操作

1. **扫描二维码**
   - 使用手机相机扫描大屏二维码
   - 或直接访问签到链接

2. **输入信息**
   - 输入员工工号
   - 输入姓名

3. **确认签到**
   - 确认信息无误后点击签到
   - 如需定位，允许位置权限

4. **签到成功**
   - 看到成功页面表示签到完成
   - 大屏会实时显示签到信息

---

## 7. 安全考虑

### 7.1 潜在风险

| 风险     | 影响 | 缓解措施            |
| -------- | ---- | ------------------- |
| 代签到   | 中   | 名单验证 + 定位限制 |
| 工号泄露 | 低   | 工号非敏感信息      |
| 数据丢失 | 中   | 定期导出签到数据    |

### 7.2 增强安全（可选）

- 启用定位验证，限制签到范围
- 导入参与者名单，启用严格验证
- 后续可增加人脸识别等高级验证

---

## 8. 部署说明

### 8.1 部署步骤

```bash
# 1. 构建生产版本
npm run build

# 2. 部署 dist 目录到静态服务器
# 例如: Nginx, Vercel, Netlify, 阿里云 OSS 等
```

### 8.2 配置签到链接

生成签到页面二维码：

```
签到页面URL: https://your-domain.com/checkin
大屏展示URL: https://your-domain.com/checkin-display
```

---

## 附录

### A. 与企业微信方案对比

| 特性         | 简化方案   | 企业微信方案   |
| ------------ | ---------- | -------------- |
| 开发时间     | 4-6 小时   | 18-28 小时     |
| 配置复杂度   | ⭐         | ⭐⭐⭐⭐⭐     |
| 身份验证强度 | ⭐⭐       | ⭐⭐⭐⭐⭐     |
| 用户体验     | 需输入信息 | 自动获取       |
| 适用范围     | 通用       | 仅企业微信用户 |

### B. 后续优化建议

1. **增加后端存储**：使用 Supabase 存储签到数据
2. **增加管理后台**：完善签到管理功能
3. **增加导出功能**：支持导出签到记录为 Excel
4. **增加实时同步**：多设备数据同步

---

_文档结束_
